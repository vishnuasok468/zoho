{% extends 'base.html' %}
{% load static %}
{% block content %}

<style>
  @media screen and (max-width: 600px) {
    .col-25, .col-75, input[type=submit] {
      width: 100%;
      margin-top: 0;
    }
    input[type=text], select, textarea {
    width: 100%;

  }
  }

    
    .form-check {
      margin-bottom: 10px;
    }
    
    /* style submit button */
    button[type="submit"] {
      background-color: #007bff;
      color: #fff;
      border: none;
      border-radius: 4px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
    
    button[type="submit"]:hover {
      background-color: #0069d9;
    }
    /* Style for the highlighted account type options */
  option.highlight-account-type {
    background-color: #f3f3f3; /* Example background color */
    color: #666; /* Example text color */
    font-weight: bold; /* Example font weight */
    /* Add any other styles you want to customize the look of the highlighted account type options */
  }
  
  /* Additional style for hovering over the highlighted account type options (optional) */
  option.highlight-account-type:hover {
    background-color: #f5f5f5; /* Example hover background color */
    /* Add any other styles you want for the hover state */
  }
  .highlight-account-type {
    text-align: left;
    padding-left: 10px;
  }
  .modal{
    z-index: 9999;
    overflow: scroll;
  }
  
    </style>
    {% comment %} <div  style="margin-top:6rem;   margin-left: 8rem;" > {% endcomment %}
      <h2>New Recurring Expenses</h2>
      <div style="height: 600px; overflow-y: scroll;overflow-x: clip;"> 
      
        <form action="{% url 'add_expense' %}" method="post" id="expenseForm">
          {% csrf_token %}
          

          <div class="form-group row mt-4">
            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Profile Name</label></div>
            <div class="col-sm-12 col-md-6 col-lg-6">
                <input  type="text" class="form-control bg-white text-dark"  name="profile_name" required style="width:100%">     
                <div class="invalid-feedback">Please fill out this field.</div>   

            </div>
          </div> 
          <div class="form-group row mt-4">
            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Repeat Every</label></div>
              <div class="col-sm-12 col-md-6 col-lg-6">
                <select class="form-control bg-white text-dark" id="repeat_every" name="repeat_every"  style="width:100%">
                  <option value="Week" disabled>Week</option>
                  <option value="2 Weeks">2 Weeks</option>
                  <option value="Month" disabled>Month</option>
                  <option value="2 Months">2 Months</option>
                  <option value="3 Months">3 Months</option>
                  <option value="6 Months">6 Months</option>
                  <option value="Year" disabled>Year</option>
                  <option value="2 Years">2 Years</option>
                  <option value="3 Years">3 Years</option>
                </select>      
              </div>
          </div>
          <div class="form-group row mt-4">
            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Start Date</label></div>
            <div class="col-sm-12 col-md-6 col-lg-6">
              <input type="date"  id="start_date" name="start_date" class="form-control bg-white text-dark" style="background-color:#2c2e33;color:black;width:100%">
            </div>
          </div>

          <div class="form-group row mt-4">
            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                <label>Ends On</label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-6">
                <input type="date" id="ends_on" name="ends_on" class="form-control bg-white text-dark" style="background-color:#2c2e33;color:black;width:100%" {% if never_expire %}disabled{% endif %}>
            </div>
            <div style="margin-left:318px;">
              <div class="form-check">
                <input type="checkbox" id="never-expire-checkbox" onchange="toggleDateInput()" name="neverExp" value='1'/>
                <label for="never-expire-checkbox" style="color: #909091;width:100%" >Never Expires</label>
                </div>
          </div>
        </div>
        <div class="form-group row mt-4">
          <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Expence Account</label></div>
          <div class="col-sm-12 col-md-6 col-lg-6">
            <div class="input-group">
              <select class="form-control bg-white text-dark" id="expense_account" name="expense_account" >
                <!-- Existing options and comment tags -->
                {% for account_type in account_types %}
                <optgroup label="{{ account_type }}">
                    {% for account in accounts %}
                    {% if account.accountType == account_type %}
                    <option value="{{ account.id }}"> {{ account.accountName }}</option>
                    {% endif %}
                    {% endfor %}
                </optgroup>
                {% endfor %}
            </select>
          
          
              <div class="input-group-append">
                <button class="btn btn-primary" type="button" data-toggle="modal" data-target="#newAccountModal" id="openModalBtn" class="text-capitalize"  style="height:38px;">New Account</button>
              </div>
            </div>
          </div>
          </div>  

          <div class="form-group row mt-4">
            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="margin-top:8px;"><label>Expence Type</label></div>
            <div class="col-sm-12 col-md-6 col-lg-6" style="display:flex;">
            <div class="form-check" >
              <input class="form-check-input" type="radio" name="expense_type" id="expense_type1" value="goods"  >
              <label class="form-check-label" for="expense_type1">
                Goods
              </label>
            </div>
            <div class="form-check" style="margin-left:30px;">
              <input class="form-check-input" type="radio" name="expense_type" id="expense_type2" value="services" >
              <label class="form-check-label" for="expense_type2">
                Services
              </label>
            </div>
            <div class="form-group" id="goods-bottom" style="display:none" >
              <div style="margin-left:-300px;"><label for="goods-label" style="margin-top:74px;margin-left:-187px;">HSN</label></div>
              <input type="text" class="form-control bg-white text-dark" id="goods-label" name="goods_label" oninput="validateHSN(this)" style="margin-left:-11.5rem;width:595px;" >
              <small id="hsn-error" class="text-danger"></small>
            </div>
            <div class="form-group" id="services-bottom" style="display:none;">
              <div style="margin-left:-300px;"><label for="services-label" style="margin-top:74px;margin-left:-187px;">SAC</label></div>
              <input type="text" class="form-control bg-white text-dark" id="services-label" name="services_label" oninput="validateSAC(this)" style="margin-left:-11.5rem;width:595px;" >
              <small id="sac-error" class="text-danger"></small>
            </div>
          </div>
          </div>

          <div class="form-group row mt-4">
            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Amount</label></div>
            <div class="col-sm-12 col-md-6 col-lg-6">
              <div class="input-group-prepend" style="margin-left:-151px;">
                <select class="form-control bg-white text-dark" id="currency" name="currency" style="width:50px; margin-left:151px;color:white;">
                  <option value="INR" >INR</option>
                </select>
              </div>
              <option value="INR" ></option><input type="text"  id="amount" name="amount" class="form-control bg-white text-dark" style="background-color:#2c2e33;color:black;margin-top:-57px;width: 560px;margin-left: 48px;">
            </div>
          </div>
          <div class="form-group row mt-4">
            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Paid Through</label></div>
            <div class="col-sm-12 col-md-6 col-lg-6">
              <select name="paidthrough" id="paidthrough" class="form-control bg-white text-dark" >
                  <option value="" disabled class="btn btn text-dark   highlight-account-type"><b>Cash</b></option>
                  <option value="Petty Cash" >Petty Cash</option>                          
                  <option value="Undeposited Funds">Undeposited Funds</option>
                  <option value="" disabled class="btn btn text-dark   highlight-account-type"><b>Other Current Asset</b></option>
                  <option value="Advance Tax" >Advance Tax</option>
                  <option value="Employee Advance" >Employee Advance </option>
                  <option value="Prepaid Expenses" >Prepaid Expenses</option>
                  <option value="" disabled class="btn btn text-dark   highlight-account-type"><b>Payment Clearing Account</b></option>
                  <option value="Stripe Clearing" >Stripe Clearing</option>


              </select>
          </div>
          </div>
    

          <div class="form-group row mt-4">
            <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Vendor</label></div>
            <div class="col-sm-12 col-md-6 col-lg-6">
            <div class="input-group">
              <select name="vendor" id="vendorSelect" class="form-control text-dark bg-light">
                <option  id="placeholderOption"  value="" class="text-dark bg-light">Select a Vendor</option>
                {% for v in vendors %}
                  
                  <option value="{{ v.id }}"  data-gst="{{ v.gst_treatment }}">{{ v.first_name }} {{ v.last_name }}</option>
                {% endfor %}
              </select>
            
              
                  <div class="input-group-append">
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#newvendor" id="addVendorButton" style="height:38px;">Add new vendor</button>
                  </div>
              </div>
            </div>
            
      
          
            <div class="form-group row mt-4">
              <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>GST Treatment</label></div>
              <div class="col-sm-12 col-md-6 col-lg-6">
                <input type="text" name="gst_trt_inp" id="gst_trt_inp" class="form-control  bg-white text-dark" style="margin-left: 6px; width: 602px;color:black;">
                  
            <div class="form-group row mt-4" id="textboxContainer" style="display: none;margin-left:5px;">
              <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Vendor GSTIN</label></div>
              

                <input type="text" id="gst_num_inp" class="form-control"  name="gstin_inp" placeholder="Enter additional information" value="" style="background-color:#2c2e33;margin-left:5.5px; width: 602px;color:black;">
              </div>
            </div>
            <div class="form-group row mt-4" id="emailid" style="display: none;">
              <label for="email" class="col-sm-12 col-md-6 col-lg-3 col-form-label">Vendor EmailId</label>
              <div class="col-sm-12 col-md-12 col-lg-6">
                  <input type="text" class="form-control bg-white text-dark" id="vemail" name="vmail" style="width: 602px; color: black;margin-left:5.9px;">
              </div>
          </div>
          </div>
        </div>

      
        <div class="form-group row mt-4">
          <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Destination of supply</label></div>
          <div class="col-sm-12 col-md-6 col-lg-6">
              <select name="destination" id="destination" class="form-control bg-white text-dark" style="margin-left: -4px; width:609px;color:black;">
                <option value="value" selected></option>
                <option value="[AN]-Andaman And Nicobar Islands">[AN]-Andaman And Nicobar Islands</option> <option value="[AD]-Andhra Pradesh">[AD]-Andhra Pradesh</option>
                <option value="[AR]-Arunachal Pradesh">[AR]-Arunachal Pradesh	</option> <option value="[AS]-Assam">[AS]-Assam</option>
                <option value="[BR]-Bihar">[BR]-Bihar</option> <option value="[CH]-	Chandhigarh">[CH]-	Chandhigarh</option><option value="[CG]-Chattisgarh">[CG]-Chattisgarh</option>
                <option value="[DD]-Daman Diu">[DD]-Daman Diu</option><option value="[DL]-	Delhi">[DL]-	Delhi</option><option value="[GA]-Goa">[GA]-Goa</option> <option value="[GJ]-Gujarat">[GJ]-Gujarat</option>
                <option value="[HR]-Haryana">[HR]-Haryana</option> <option value="[HP]-Himachal Pradesh">[HP]-Himachal Pradesh</option>
                <option value="[JK]-Jammu And Kashmir">[JK]-Jammu And Kashmir</option><option value="[JH]-Jharkand">[JH]-Jharkand</option>
                <option value="[KA]-Karnataka">[KA]-Karnataka</option><option value="[KL]-Kerala">[KL]-Kerala</option>
                <option value="[LA]-Ladakh">[LA]-Ladakh</option><option value="[LD]-Lakshadweep">[LD]-Lakshadweep</option>
                <option value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option><option value="[MH]-Maharashtra">[MH]-Maharashtra</option>
                <option value="[MN]-Manipur">[MN]-Manipur</option>  <option value="[ML]-Meghalaya">[ML]-Meghalaya</option>
                <option value="[MZ]-Mizoram">[MZ]-Mizoram</option> <option value="[NL]-Nagaland">[NL]-Nagaland</option> <option value="[NL]-Nagaland">[NL]-Nagaland</option>
                <option value="[OD]-Odisha">[OD]-Odisha</option><option value="[PY]-Puducherry">[PY]-Puducherry</option>
                <option value="[PB]-Punjab">[PB]-Punjab.</option><option value="[RL]-Rajasthan">[RL]-Rajasthan</option>
                <option value="[SK]-Sikkim">[SK]-Sikkim</option><option value="[TN]-Tamilnadu">[TN]-Tamilnadu</option>
                <option value="[TS]-Telenghana">[TS]-Telenghana</option><option value="[TR]-Tripura">[TR]-Tripura</option><option value="[UP]-Uttar Pradesh">[UP]-Uttar Pradesh</option>
                <option value="[UK]-Utharakhand">[UK]-Utharakhand</option><option value="[WB]-West Bengal">[WB]-West Bengal</option>
                <option value="[OT]-Other Territory">[OT]-Other Territory</option>
              </select>
        </div>
      </div>
          <div class="form-group row mt-4">
            <div class="row">
              <div class="col-md-3 col-form-label"><label>Tax</label></div>
              <div class="col-md-3">
                <select name='tax[]' id='tax1'
                class='form-control bg-light text-dark  text-right border-0 tax' onclick="toggleTaxInput()" style="margin-left: -4px; width: 609px; color: black;">
                <optgroup class="text-left" label="GST">
                  <option value="0" selected></option>
                  <option value="GST0">0% GST(0%)</option>
                  <option value="GST3">3.0% GST(3%)</option>
                  <option value="GST5">5.0% GST(5%)</option>
                  <option value="GST12">12.0% GST(12%)</option>
                  <option value="GST18">18.0% GST(18%)</option>
                  <option value="GST28">28.0% GST(28%)</option>
                </optgroup>
                <optgroup  class="text-center" label="IGST">
                  <option value="0">0% IGST(0%)</option>
                  <option value="IGST3">3.0% IGST(3%)</option>
                  <option value="IGST5">5.0% IGST(5%)</option>
                  <option value="IGST12">12.0% IGST(12%)</option>
                  <option value="IGST18">18.0% IGST(18%)</option>
                  <option value="IGST28">28.0% IGST(28%)</option>             
                  </optgroup>
            </select>
              </div>
          </div>
          
                    
              <div class="form-group row mt-4">
                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Notes</label></div>
                <div class="col-sm-12 col-md-6 col-lg-6">
                  <input type="text" class="form-control bg-white text-dark" id="notes" name="notes" style="margin-left:-5px; width: 609px;color:black;">
              </div>
            </div>
            <div class="form-group row mt-4">
              <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Customer Name</label></div>
              <div class="col-sm-12 col-md-6 col-lg-6">
                  <div class="input-group" style="width: 617px;">
                    
                      <select class="form-control bg-white text-dark" id="customer-list" name="customername" style="color: black; ">
                        <option value="" selected class="text-dark bg-light">Select a customer</option>
                        {% for c in customers %}
                          
                          <option value="{{ c.id }}"  >{{ c.customerName }}</option>
                        {% endfor %}
                      </select>
                      <div class="input-group-append">
                          <button class="btn btn-primary" type="button" data-toggle="modal" data-target="#newcustomer" style="height: 38px;">Add new customer</button>
                      </div>
                  </div>
              </div>
          </div>
          
          <div class="form-group row mt-4" id="emailField" style="display: none;">
              <label for="email" class="col-sm-12 col-md-6 col-lg-3 col-form-label">Customer EmailId</label>
              <div class="col-sm-12 col-md-12 col-lg-6">
                  <input type="text" class="form-control bg-white text-dark" id="email" name="mail" style="width: 100%; color: black;">
              </div>
          </div>
          
            

            
            <div class="form-group row mt-4">
              <!-- Add a hidden input field for the activation tag with value "active" -->
              <input type="hidden" name="activation_tag" value="active">
          </div>
          <br><br>
          <div class="form-group" >
              <button type="submit" class="btn btn-primary">Save</button>&nbsp;&nbsp;
              <button type="button" class="btn btn-secondary" onclick="window.location.href='{% url 'recurringbase' %}'" style="color:orangered;">Cancel</button>
          </div>
      </form>
      </div>

      <script>
        // Get references to the input elements
        var startDateInput = document.getElementById("start_date");
        var endsOnInput = document.getElementById("ends_on");
    
        // Listen for changes in the "Start Date" input
        startDateInput.addEventListener("change", function () {
            // Parse the selected date
            var selectedStartDate = new Date(startDateInput.value);
    
            // Calculate the date one day after the selected "Start Date"
            var oneDayAfterStartDate = new Date(selectedStartDate);
            oneDayAfterStartDate.setDate(selectedStartDate.getDate() + 1);
    
            // Format the date in yyyy-mm-dd for setting as min
            var formattedDate = oneDayAfterStartDate.toISOString().split("T")[0];
    
            // Update the "Ends On" input's min attribute
            endsOnInput.min = formattedDate;
        });
    </script>
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script>
      $(document).ready(function() {
          // Event listener for the vendor dropdown
          $('#vendorSelect').on('change', function() {
              // Get the selected vendor's ID
              var selectedVendorId = $(this).val();
      
              // Check if a vendor is selected
              if (selectedVendorId !== '') {
                  // Send an AJAX request to fetch the GST treatment, GST number, and email for the selected vendor
                  $.ajax({
                      url: '/get_vendor_gst/' + selectedVendorId, // Replace with the actual URL to fetch vendor info
                      method: 'GET',
                      success: function(data) {
                          console.log('Received data:', data);
      
                          // Update the GST treatment input field with the fetched data
                          $('#gst_trt_inp').val(data.gst_treatment);
      
                          // Show or hide the GST number input field based on GST treatment
                          if (data.gst_treatment === 'unregistered Business') {
                              $('#textboxContainer').hide();
                          } else {
                              $('#textboxContainer').show();
                              $('#gst_num_inp').val(data.gst_number); // Update GST number
                          }
      
                          // Display the email input field with the fetched email
                          $('#vemail').val(data.email);
                          $('#emailid').show(); // Show the email input field container
                      },
                      error: function(error) {
                          console.log('Error fetching data:', error);
                      }
                  });
              } else {
                  // Clear the input fields and hide the GST number input field if no vendor is selected
                  $('#gst_trt_inp').val('');
                  $('#gst_num_inp').val('');
                  $('#vemail').val('');
                  $('#textboxContainer').hide();
                  $('#emailid').hide(); // Hide the email input field container
              }
          });
      
          // Rest of your JavaScript code...
      });
      </script>
      

      <script>
        function toggleTaxInput() {
          var destinationSelect = document.getElementById("destination");
          var selectedOption = destinationSelect.options[destinationSelect.selectedIndex].value;
          
          var taxSelect = document.getElementById("tax1"); // Assuming you want to change the first tax dropdown
      
          if (selectedOption === "[KL]-Kerala") {
            // Show GST options and hide IGST options
            var gstOptgroup = taxSelect.querySelector('optgroup[label="GST"]');
            var igstOptgroup = taxSelect.querySelector('optgroup[label="IGST"]');
            gstOptgroup.style.display = "block";
            igstOptgroup.style.display = "none";
          } else {
            // Show IGST options and hide GST options
            var gstOptgroup = taxSelect.querySelector('optgroup[label="GST"]');
            var igstOptgroup = taxSelect.querySelector('optgroup[label="IGST"]');
            gstOptgroup.style.display = "none";
            igstOptgroup.style.display = "block";
          }
        }
      </script>


      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script>
          $(document).ready(function() {
              $('#customer-list').change(function() {
                  var selectedCustomer = $(this).val();
                  if (selectedCustomer !== '') {
                      // Show the email input field
                      $('#emailField').show();
      
                      // Fetch the email using AJAX and populate the input field
                      $.ajax({
                          url: "{% url 'get_customer_email' %}",
                          data: { customername: selectedCustomer },
                          dataType: 'json',
                          success: function(data) {
                              if (data.email) {
                                  $('#email').val(data.email);
                              } else {
                                  // Handle the case where no email is found
                                  $('#email').val('');
                              }
                          },
                          error: function(xhr, status, error) {
                              console.error(xhr.responseText);
                          }
                      });
                  } else {
                      // Hide the email input field if no customer is selected
                      $('#emailField').hide();
                  }
              });
          });
      </script>
      

      




    
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script>
$(document).ready(function() {
    // Event listener for the vendor dropdown
    $('#vendorSelect').on('change', function() {
        // Get the selected vendor's ID
        var selectedVendorId = $(this).val();

        // Check if a vendor is selected
        if (selectedVendorId !== '') {
            // Send an AJAX request to fetch the GST treatment and GST number for the selected vendor
            $.ajax({
                url: '/get_vendor_gst/' + selectedVendorId, // Replace with the actual URL to fetch GST treatment and GST number
                method: 'GET',
                success: function(data) {
                    console.log('Received data:', data); // Add this line to check the received data
                    // Update the GST treatment and GST number input fields with the fetched data
                    $('#gst_trt_inp').val(data.gst_treatment);
                    $('#gst_num_inp').val(data.gst_number);
                },
                error: function(error) {
                    console.log('Error fetching GST treatment and GST number:', error);
                }
            });
        } else {
            // Clear the GST treatment and GST number input fields if no vendor is selected
            $('#gst_trt_inp').val('');
            $('#gst_num_inp').val('');
        }
    });

    // Rest of your JavaScript code...
});

      </script>
      
      
      
      
    <script>
      function toggleDateInput() {
        var checkbox = document.getElementById("never-expire-checkbox");
        var dateInput = document.getElementById("ends_on");
        
        if (checkbox.checked) {
            dateInput.disabled = true;
           
           // $("#terms").val("recpt");
        } 
        else {
            dateInput.disabled = false;
        }
    }
    
  
    </script>
      

    <script>
      function toggleDate() {
          var endsOnInput = document.getElementById("ends_on");
          var neverExpireCheckbox = document.getElementById("never-expire-checkbox");
          var startDateInput = document.getElementById("start_date");
  
          if (neverExpireCheckbox.checked) {
              endsOnInput.disabled = true;
              endsOnInput.value = ""; // Clear the "Ends On" date
          } else {
              endsOnInput.disabled = false;
          }
      }
  
      // Add an event listener to the "Start Date" input to prevent selecting the same date in "Ends On"
      var startInput = document.getElementById("start_date");
      var endsOnInput = document.getElementById("ends_on");
  
      startInput.addEventListener("change", function () {
          // Disable the "Ends On" date input if it matches the "Start Date"
          if (startInput.value === endsOnInput.value) {
              endsOnInput.value = ""; // Clear the "Ends On" date
          }
      });
  </script>
      
    <div class="modal fade" id="newAccountModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="false">
      <!-- Modal content here -->
      <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background: rgb(32, 35, 37); border-radius: 20px;">
          <div class="modal-header" style="background: rgb(32, 35, 37);">
            <h3 class="m-3 text-uppercase">New Account</h3>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body" style="background: rgb(32, 35, 37);">
            <div class="card p-3 m-3">
              <form action=" " method="post" class="needs-validation" novalidate autocomplete="off" id="accountForm">
                {% csrf_token  %}
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="accountType">Account Type:</label>
                    <select class="form-control bg-white text-dark" id="accountType" name="accountType" required>
                      <option value=""  class="btn btn text-dark   highlight-account-type">Select an Account</option>
                      <option value=""  ><b>Assets</b></option>
                      <option value="Other Current Asset">Other Current Asset</option>
                      <option value="Cash">Cash </option>
                      <option value="Bank">Bank </option>
                      <option value="Stock">Stock </option>
                      <option value="Payment Clearing">Payment Clearing </option>
                      <option value="Fixed Asset">Fixed Asset</option>
                      
                      <option value=""  disabled class="btn btn text-dark   highlight-account-type"><b>Liability</b></option>
                      <option value="Other Liability">Other Liability</option>
                      <option value="Other Current Liability">Other Current Liability</option>
                      <option value="Credit Card">Credit Card</option>
                      <option value="Long Term Liability">Long Term Liability</option>
                      <option value="Overseas Tax Pyable">Overseas Tax Pyable</option>
                      
                      <option value="" disabled class="btn btn text-dark   highlight-account-type"><b>Expense</b></option>
                      <option value="Expenses">Expenses</option>
                      <option value="Cost Of Goods Sold">Cost Of Goods Sold</option>
                      <option value="Other Expense">Other Expense</option>
                      <option value="" disabled class="btn btn text-dark   highlight-account-type"><b>Equatity</b></option>
                      <option value="Equality">Equatity</option>
                      <option value="" disabled class="btn btn text-dark   highlight-account-type"><b>Income</b></option>
                      <option value="Income">Income</option>
                      <option value="other Income">Other Income</option>
                    
                    
                    </select>
                  </div>
                  <div class="form-group col-md-6">
                    <label for="accountName">Account Name:</label>
                    <input type="text" class="form-control bg-white text-dark" id="accountName" name="accountName" required>
                  </div>
                </div>
                
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="accountCode">Account Code:</label>
                    <input type="text" class="form-control  bg-white text-dark" id="accountCode" name="accountCode" required>
                  </div>
                  <div class="form-group col-md-6">
                    <label for="description">Description:</label>
                    <textarea class="form-control bg-white text-dark" id="description" name="description" rows="3" required></textarea>
                  </div>
                </div>
                
                
                <div class="form-row mt-3">
                  <div class="col-md-6">
                    <button type="submit" class="btn btn-primary" style="margin-left:430px;width:150px;"  id="accountSave">Save and Select</button>
                  </div>
                  <div class="col-md-6">
                    <!-- No need for the close button here -->
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
     
      
      
      



    
   
   



<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function() {
    // Function to open the modal
    $("#openModalBtn").click(function() {
        $('#newAccountModal').modal('show');
    });

    // Function to handle form submission
    $("#accountForm").on("submit", function(event) {
        event.preventDefault();

        // Client-side validation
        var accountType = $("#accountType").val();
        var accountName = $("#accountName").val();
        if (!accountType || !accountName) {
            alert("Please fill in all required fields.");
            return;
        }

        var formData = new FormData($(this)[0]);

        $.ajax({
            url: "{% url 'save_recurring_data' %}",  // Replace with your Django URL
            type: "POST",
            data: formData,
            processData: false,
            contentType: false,
            success: function(response) {
                console.log('Success:', response);
                // Update the dropdown options
                updateDropdown(response);

                // Clear the form fields
                $("#accountForm")[0].reset();

                // Close the modal
                $('#newAccountModal').modal('hide');
                closeForm();
            },
            error: function(error) {
                console.log("AJAX error:", error);
            }
        });
    });


        function updateDropdown(response) {
            var expenseAccountDropdown = $("#expense_account");
            var accountType = response.account_type;
            var accountName = response.account_name;
            var accountId = response.acc_id;

            // Find or create the <optgroup> for the account type
            var optgroup = expenseAccountDropdown.find("optgroup[label='" + accountType + "']");
            if (optgroup.length === 0) {
                optgroup = $("<optgroup>").attr("label", accountType);
                expenseAccountDropdown.append(optgroup);
            }

            // Check if an option with the same text (accountName) already exists within the optgroup
            var existingOption = optgroup.find("option:contains('" + accountName + "')");

            if (existingOption.length === 0) {
                // Create a new option element
                var newOption = $("<option>")
                    .val(accountId)
                    .text(accountName);

                // Append the new option to the optgroup
                optgroup.append(newOption);
            }
        }
    });
    function closeForm() {
      let formContainer = document.getElementById("newAccountModal");
      formContainer.style.display = "none";
  }
</script>


<!--Add Newcustomer -->
<div class="modal fade" id="newcustomer">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header " style="background: rgb(32, 35, 37);">
          <h3 class="m-3 text-uppercase">New Customer</h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3">
          <form action="" method="post" class="needs-validation"  id="customerForm">
            {% csrf_token %}
    
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="">Customer Type</label><br>
              </div>
              <div class="col-md-6 mt-2">
                <div class="d-flex">
                  <div class="radio_opt mx-5 mt-2">
                    <input type="radio" id="business" name="radioCust" value="Business" >
                    <label for="option1">Business</label>
                  </div>
                  <div class="radio_opt mx-4 mt-2">
                    <input type="radio" id="individual" name="radioCust" value="Individual" >
                    <label for="option2">Individual</label>
                  </div>
                </div>
              </div>
            </div>
            <div class="row mt-5">
              <div class="col-md-3">
                <label for="ctitle">Title</label>
              </div>
              <div class="col-md-3">
                <select name="ctitle" id="ctitle" class="form-control text-dark bg-light">
                  <option value="Mr." selected>Mr.</option>
                  <option value="Mrs.">Mrs.</option>
                  <option value="Ms.">Ms.</option>
                  <option value="Miss.">Miss.</option>
                  <option value="Dr.">Dr.</option>
                </select>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="cfname">First name</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="cfname" name="cfirstname" required>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="clname">Last name</label>
                <label for="cdisplayname" name = "cdisplayname" hidden></label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="clname" name="clastname">
                <input type="hidden"  id="cdisplayname" name="cdisplayname">
              </div>
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="ccompany">Company Name</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="ccompany" name="ccompany_name">
              </div>
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="cemail">Customer Email</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="email" class="form-control text-dark bg-light" id="cemail" name="cemail" placeholder="example@gmail.com" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$">    
              </div>              
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="email">Customer Phone</label>
              </div>
              <div class="col-md-3 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="cw_mobile" placeholder="Work Number" maxlength="10" name="cw_mobile">
              </div>        
              <div class="col-md-3 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="cp_mobile" placeholder="Personal Number" maxlength="10" name="cp_mobile">
              </div>          
            </div>

       
            <hr>
            <center><h4 class="text-uppercase mb-3"><b>Other Details</b></h4></center>
            <div class="row mt-5">
              <div class="col-md-3 mt-2">
                <label for="facebook">Facebook</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="facebook" placeholder="www.example.com" name="facebook">
              </div>       
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="twitter">Twitter</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="twitter" placeholder="www.example.com" name="twitter">
              </div>       
            </div>


            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="website">Website</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="website" placeholder="www.example.com" name="website">
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="cskype">Skype name/Number</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="cskype" name="cskype">
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_desg">Designation</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="c_desg" name="c_desg">
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_dpt">Department</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="c_dpt" name="c_dpt">
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_gsttype" style="color:rgb(190, 88, 88);">GST Treatment *</label>
              </div>
              <div class="col-md-6 mt-2">
                <select class="form-control text-dark bg-light" id="c_gsttype" name="c_gsttype" required>
                  <option value="value" selected>Select a Gst Treatment</option>
                  <option value="Registered Business-Regular Business that is registered under GST">Registered Business-Regular Business that is registered under GST</option>
                  <option value="Registered Business-Composition Business that is registered under the Composition scheme in GST">Registered Business-Composition Business that is registered under the Composition scheme in GST</option>
                  <option value="Unregistered Business-not Registered under GST">Unregistered Business-not Registered under GST</option>
                  <option value="Consumer- A customer who is a regular Consumer">Consumer- A customer who is a regular Consumer</option>
                  <option value="Overseas- Persons with who you do import or exports of supplies outside india">Overseas- Persons with who you do import or exports of supplies outside india</option>
                  <option value="Special Economic Zone">Special Economic Zone</option>
                </select>
              </div>       
            </div>

             <div class="row gstrow d-none">
              <div class="col-md-3 mt-2">
                <label id="glbl" style="color:rgb(190, 88, 88);">GSTIN/UIN *</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control" id="v_gstin" name="v_gstin" placeholder="29APPCK7465F1Z1">
                <label id="gst_label"></label>
              </div>       
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="v_pan">PAN Number</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control" id="v_pan" name="v_pan" placeholder="APPCK7465F">
                <label id="pan_label"></label>
              </div>       
            </div> 

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="" style="color: rgb(190, 88, 88);">Place of Supply *</label>
              </div>
              <div class="col-md-6 mt-2">
                <select class="form-control text-dark bg-light" id="placesupply" name="placesupply">
                  <option value="Nill"></option>
                  <option value="[AN] Andaman and Nicobar Islads">[AN] Andaman and Nicobar Islads</option>
                  <option value="[AD] Andhra Predhesh">[AD] Andhra Predhesh</option>
                  <option value="[AR] Arunachal Predesh">[AR] Arunachal Predesh</option>
                  <option value="[AS] Assam">[AS] Assam</option>
                  <option value="[BR] Bihar">[BR] Bihar</option>
                  <option value="[CH] Chandigarh">[CH] Chandigarh</option>
                  <option value="[CG] Chhattisgarh">[CG] Chhattisgarh</option>
                  <option value="[DNH] Dadra and Nagar Haveli">[DNH] Dadra and Nagar Haveli</option>
                  <option value="[DD] Damn anad Diu">[DD] Damn anad Diu</option>
                  <option value="[DL] Delhi">[DL] Delhi</option>
                  <option value="[GA] Goa">[GA] Goa</option>
                  <option value="[GJ] Gujarat">[GJ] Gujarat</option>
                  <option value="[HR] Haryana">[HR] Haryana</option>
                  <option value="[HP] Himachal Predesh">[HP] Himachal Predesh</option>
                  <option value="[JK] Jammu and Kashmir">[JK] Jammu and Kashmir</option>
                  <option value="[JH] Jharkhand">[JH] Jharkhand</option>
                  <option value="[KA] Karnataka">[KA] Karnataka</option>
                  <option value="[KL] Kerala">[KL] Kerala</option>
                  <option value="[LA] Ladakh">[LA] Ladakh</option>
                  <option value="[LD] Lakshadweep">[LD] Lakshadweep</option>
                  <option value="[MP] Madhya Predesh">[MP] Madhya Predesh</option>
                  <option value="[MH] Maharashtra">[MH] Maharashtra</option>
                  <option value="[MN] Manipur">[MN] Manipur</option>
                  <option value="[ML] Meghalaya">[ML] Meghalaya</option>
                  <option value="[MZ] Mizoram">[MZ] Mizoram</option>
                  <option value="[NL] Nagaland">[NL] Nagaland</option>
                  <option value="[OD] Odisha">[OD] Odisha</option>
                  <option value="[PY] Puducherry">[PY] Puducherry</option>
                  <option value="[PB] Punjab">[PB] Punjab</option>
                  <option value="[RJ] Rajasthan">[RJ] Rajasthan</option>
                  <option value="[SK] Sikkim">[SK] Sikkim</option>
                  <option value="[TN] Tamil Nadu">[TN] Tamil Nadu</option>
                  <option value="[TS] Telangana">[TS] Telangana</option>
                  <option value="[TR] Tripura">[TR] Tripura</option>
                  <option value="[UP] Uttar Predesh">[UP] Uttar Predesh</option>
                  <option value="[UK] Uttarakhand">[UK] Uttarakhand</option>
                  <option value="[WB] West Bengal">[WB] West Bengal</option>
                  <option value="[OT] Other Territory">[OT] Other Territory</option>
                </select>
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_tax" style="color: rgb(190, 88, 88);">Tax Preference* </label>
              </div>
              <div class="col-md-6 mt-2">
                <div class="d-flex">
                  <div class="radio_opt mx-5 mt-2">
                    <input type="radio" id="custtax1" name="radioCust1" value="Taxable" >
                    <label for="option1">Taxable</label>
                  </div>
                  <div class="radio_opt mx-4 mt-2">
                    <input type="radio" id="custtax2" name="radioCust1" value="Tax-exempt" >
                    <label for="option2">Tax-exempt</label>
                  </div>
                </div>
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_curn">Currency </label>
              </div>
              <div class="col-md-3 mt-2">
                <select class="form-control text-dark bg-light" id="c_curn" name="c_curn" required>
                  <option selected disabled value="">Choose..</option>
                  <option value="INR">INR</option>
                </select>
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_open">Opening Balance</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="c_open" name="c_open">
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_terms">Payment Terms</label>
              </div>
              <div class="col-md-6 mt-2">
                <div class="d-flex">
                  <select class="form-control text-dark bg-light" id="c_terms" name="c_terms" required>
                    
                    {% for p in payments %}
                    <option value="{{p.id}}">{{p.Terms}}</option>
                    {% endfor %}
                  </select>                
                  <a href="#" class="btn btn-outline-secondary py-2 my-1" data-target="#newpayment" data-toggle="modal">+</a>   
                </div>
              </div>       
            </div>
            

            <hr>

            <div class="row mt-2">
              <div class="col-md-6 mt-5 text-center text-uppercase">
                <h4 class="mb-0">Billing Address</h4>
              </div>
              <div class="col-md-6 mt-5">
                <h4 class="mb-0 text-center text-uppercase">Shipping Address</h4>
              </div>
            </div>
            <div class="row mt-2 m-0 p-0 mb-2">
              <div class="col-md-9"> </div>
              <div class="col-md-3 text-right  m-0 p-0">
                <input type="checkbox" onclick="address()" id="csokay" name="csokay">
                <label for="csokay" style="color: #909091;">Same As Billing Address</label>
              </div>
            </div>

            <div class="row mt-5">
              <div class="col-md-1">
                <label for="cstreet1">Address 1</label>
              </div>
              <div class="col-md-4">
                <textarea class="form-control street text-dark bg-light" id="cstreet1" name="cstreet1"></textarea>
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csstreet1">Address 1</label>
              </div>
              <div class="col-md-4 ">
                <textarea class="form-control street text-dark bg-light" id="csstreet1" name="csstreet1"></textarea>
              </div>
              <div class="col-md-1"></div>

            </div>
            <div class="row mt-5">
              <div class="col-md-1">
                <label for="cstreet2">Address 2</label>
              </div>
              <div class="col-md-4">
                <textarea class="form-control street text-dark bg-light" id="cstreet2" name="cstreet2"></textarea>
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csstreet2">Address 2</label>
              </div>
              <div class="col-md-4 ">
                <textarea class="form-control street text-dark bg-light" id="csstreet2" name="csstreet2"></textarea>
              </div>
              <div class="col-md-1"></div>

            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="ccity">City</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="ccity" name="ccity" placeholder="City">  
              </div>
              <div class="col-md-1">
              </div>
              <div class="col-md-1">
                <label for="cscity">City</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="cscity" name="cscity" placeholder="City">  
              </div>
              <div class="col-md-1">
              </div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="cstate">State</label>
              </div>
              <div class="col-md-4">
                <select type="text" class="form-control text-dark bg-light" id="cstate" name="cstate">
                  <option value="" selected>Choose</option>
                  <option value="None Of This">None Of This</option>
                  <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads</option>
                  <option value="Andhra Predhesh">Andhra Predhesh</option>
                  <option value="Arunachal Predesh">Arunachal Predesh</option>
                  <option value="Assam">Assam</option>
                  <option value="Bihar">Bihar</option>
                  <option value="Chandigarh">Chandigarh</option>
                  <option value="Chhattisgarh">Chhattisgarh</option>
                  <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                  <option value="Damn anad Diu">Damn anad Diu</option>
                  <option value="Delhi">Delhi</option>
                  <option value="Goa">Goa</option>
                  <option value="Gujarat">Gujarat</option>
                  <option value="Haryana">Haryana</option>
                  <option value="Himachal Predesh">Himachal Predesh</option>
                  <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                  <option value="Jharkhand">Jharkhand</option>
                  <option value="Karnataka">Karnataka</option>
                  <option value="Kerala">Kerala</option>
                  <option value="Ladakh">Ladakh</option>
                  <option value="Lakshadweep">Lakshadweep</option>
                  <option value="Madhya Predesh">Madhya Predesh</option>
                  <option value="Maharashtra">Maharashtra</option>
                  <option value="Manipur">Manipur</option>
                  <option value="Meghalaya">Meghalaya</option>
                  <option value="Mizoram">Mizoram</option>
                  <option value="Nagaland">Nagaland</option>
                  <option value="Odisha">Odisha</option>
                  <option value="Puducherry">Puducherry</option>
                  <option value="Punjab">Punjab</option>
                  <option value="Rajasthan">Rajasthan</option>
                  <option value="Sikkim">Sikkim</option>
                  <option value="Tamil Nadu">Tamil Nadu</option>
                  <option value="Telangana">Telangana</option>
                  <option value="Tripura">Tripura</option>
                  <option value="Uttar Predesh">Uttar Predesh</option>
                  <option value="Uttarakhand">Uttarakhand</option>
                  <option value="West Bengal">West Bengal</option>
                  <option value="Other Territory">Other Territory</option>
                </select>
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csstate">State</label>
              </div>
              <div class="col-md-4 ">
                <select type="text" class="form-control text-dark bg-light" id="csstate" name="csstate">
                  <option value="" selected>Choose</option>
                  <option value="None Of This">None Of This</option>
                  <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads
                  </option>
                  <option value="Andhra Predhesh">Andhra Predhesh</option>
                  <option value="Arunachal Predesh">Arunachal Predesh</option>
                  <option value="Assam">Assam</option>
                  <option value="Bihar">Bihar</option>
                  <option value="Chandigarh">Chandigarh</option>
                  <option value="Chhattisgarh">Chhattisgarh</option>
                  <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                  <option value="Damn anad Diu">Damn anad Diu</option>
                  <option value="Delhi">Delhi</option>
                  <option value="Goa">Goa</option>
                  <option value="Gujarat">Gujarat</option>
                  <option value="Haryana">Haryana</option>
                  <option value="Himachal Predesh">Himachal Predesh</option>
                  <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                  <option value="Jharkhand">Jharkhand</option>
                  <option value="Karnataka">Karnataka</option>
                  <option value="Kerala">Kerala</option>
                  <option value="Ladakh">Ladakh</option>
                  <option value="Lakshadweep">Lakshadweep</option>
                  <option value="Madhya Predesh">Madhya Predesh</option>
                  <option value="Maharashtra">Maharashtra</option>
                  <option value="Manipur">Manipur</option>
                  <option value="Meghalaya">Meghalaya</option>
                  <option value="Mizoram">Mizoram</option>
                  <option value="Nagaland">Nagaland</option>
                  <option value="Odisha">Odisha</option>
                  <option value="Puducherry">Puducherry</option>
                  <option value="Punjab">Punjab</option>
                  <option value="Rajasthan">Rajasthan</option>
                  <option value="Sikkim">Sikkim</option>
                  <option value="Tamil Nadu">Tamil Nadu</option>
                  <option value="Telangana">Telangana</option>
                  <option value="Tripura">Tripura</option>
                  <option value="Uttar Predesh">Uttar Predesh</option>
                  <option value="Uttarakhand">Uttarakhand</option>
                  <option value="West Bengal">West Bengal</option>
                  <option value="Other Territory">Other Territory</option>
                </select>
              </div>

              <div class="col-md-1"></div>

            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="ccountry">Country</label>
              </div>
              <div class="col-md-4 ">
                <input type="text" class="form-control text-dark bg-light" id="ccountry" name="ccountry" placeholder="Country">  
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="cscountry">Country</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="cscountry"  name="cscountry" placeholder="Country">
              </div>
              <div class="col-md-1 "></div>

            </div>

            <div class="row mt-2">

              <div class="col-md-1">
                <label for="cpincode">Pincode</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="cpincode" name="cpincode" maxlength="6" placeholder="PIN Code"> 
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="cspincode">Pincode</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="cspincode" name="cspincode" maxlength="6" placeholder="PIN Code">  
              </div>
              <div class="col-md-1"></div>

            </div>

            <div class="row mt-2">

              <div class="col-md-1">
                <label for="cphone">Phone</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="cphone" name="cphone" placeholder="Phone"> 
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csphone">Phone</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="csphone" name="csphone" placeholder="Phone">  
              </div>
              <div class="col-md-1"></div>

            </div>

            <div class="row mt-2">

              <div class="col-md-1">
                <label for="cfax">Fax</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="cfax" name="cfax" placeholder="FAX"> 
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csfax">Fax</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="csfax" name="csfax" placeholder="FAX">  
              </div>
              <div class="col-md-1"></div>

            </div>

            <div class="row mt-2">
                <div class="col-md-6">
                  <input type="checkbox" value="" id="invalidCheck" name="invalidCheck" required>
                  <label for="invalidCheck" style="color: #909091;">Agree to terms and conditions</label>
                  <div class="invalid-feedback text-warning" >You must agree before submitting.</div>
                </div>
            </div>
            <div class="row mt-5">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                  type="submit" data-dismiss="modal" id="addCustomerButton">Submit  
                  </button> 

                  <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                    data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
              </div>
          </div>
      </div>
  </div>  
</div>  




<!--End Cutomer-->

<script>
  $(document).ready(function() {
    $("#cfname, #clname").change(function() {
      // Assuming #title is an input field containing a title (e.g., Mr., Mrs., etc.)
      var title = $("#ctitle").val() || ""; // Use an empty string if title is not provided
      var firstName = $("#cfname").val() || "";
      var lastName = $("#clname").val() || "";
      var fullName = title + " " + firstName + " " + lastName;
      $("#cdisplayname").val(fullName);
      console.log(fullName)
    });
  });
</script>


<!-- Include jQuery library -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
  $(document).ready(function() {
      // Handle clicking the "Add Customer" button in the modal
      $("#addCustomerButton").on("click", function() {
          var formData = $("#customerForm").serialize(); // Replace "customerForm" with the actual form ID

          $.ajax({
              url: "{% url 'entr_recurring_custmr' %}", // Change to the actual URL
              type: "POST",
              data: formData,
              success: function(data) {
                  // Clear the form fields
                  $("#customerForm")[0].reset();

                  // Close the modal
                  $("#newcustomer").modal("hide");

                  // Update the customer dropdown list
                  updateCustomerDropdown();
              },
              error: function(error) {
                  console.log("Error:", error);
              }
          });
      });

      // Function to update the customer dropdown list
      function updateCustomerDropdown() {
          var customerListSelect = $("#customer-list");

          $.ajax({
              url: "{% url 'get_customer_namess' %}", // Change to the actual URL
              type: "GET",
              success: function(data) {
                  customerListSelect.empty();
                  data.forEach(function(customer) {
                      customerListSelect.append("<option value='" + customer.id + "'>" + customer.name + "</option>");
                  });
              },
              error: function(error) {
                  console.log("Error:", error);
              }
          });
      }

      // Initial update of the customer dropdown list
      updateCustomerDropdown();
  });
  </script>

  <div class="modal fade" id="newvendor" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document" >
      <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
        <div class="modal-header" style="background: rgb(32, 35, 37);">
          <h3 class="modal-title m-3 text-uppercase" id="exampleModalLabel">New Vendor</h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" >
          <div class="card p-3 m-3">
            <form action="" method="post" class="needs-validation" novalidate id="vendorForm">
              {% csrf_token %}

              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="validationCustom01">Title</label>
                </div>
                <div class="col-md-3 mt-2">
                  <select name="title" id="title" class="form-control text-dark bg-light">
                    <option value="Mr.">Mr.</option>
                    <option value="Mrs.">Mrs.</option>
                    <option value="Miss">Miss.</option>
                    <option value="Ms.">Ms.</option>
                  </select>
                </div>
              </div>
              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="fname">First name</label>
                </div>
                <div class="col-md-6 mt-2">
                  <input type="text" class="form-control text-dark bg-light" id="fname" name="firstname" required>
                </div>
              </div>
              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="lname">Last name</label>
                  <label id="vdisplayname" name = "vdisplayname" hidden></label>
                </div>
                <div class="col-md-6 mt-2">
                  <input type="text" class="form-control text-dark bg-light" id="lname" name="lastname">
                  
                </div>
              </div>

              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="company">Company Name</label>
                </div>
                <div class="col-md-6 mt-2">
                  <input type="text" class="form-control text-dark bg-light" id="vcompany" name="vcompany_name">
                </div>
              </div>

              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="email">Email</label>
                </div>
                <div class="col-md-6 mt-2">
                  <input type="email" class="form-control text-dark bg-light" id="vemail" name="vemail" placeholder="example@gmail.com">    
                </div>              
              </div>

              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="email">Vendor Phone</label>
                </div>
                <div class="col-md-3 mt-2">
                  <input type="text" class="form-control text-dark bg-light" id="vw_mobile" placeholder="Work Number" maxlength="10" name="vw_mobile">
                </div>        
                <div class="col-md-3 mt-2">
                  <input type="text" class="form-control text-dark bg-light" id="vp_mobile" placeholder="Personal Number" maxlength="10" name="vp_mobile">
                </div>          
              </div>

        
              <hr>
              <center><h4 class="text-uppercase mb-3"><b>Other Details</b></h4></center>

              <div class="row mt-5">
                <div class="col-md-3 mt-2">
                  <label for="wsite">Website</label>
                </div>
                <div class="col-md-6 mt-2">
                  <input type="text" class="form-control text-dark bg-light" id="wsite" placeholder="www.example.com" name="website">
                </div>       
              </div>

              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="vskype">Skype name/Number</label>
                </div>
                <div class="col-md-6 mt-2">
                  <input type="text" class="form-control text-dark bg-light" id="vskype" name="vskype">
                </div>       
              </div>

              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="v_desg">Designation</label>
                </div>
                <div class="col-md-6 mt-2">
                  <input type="text" class="form-control text-dark bg-light" id="v_desg" name="v_desg">
                </div>       
              </div>

              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="v_dpt">Department</label>
                </div>
                <div class="col-md-6 mt-2">
                  <input type="text" class="form-control text-dark bg-light" id="v_dpt" name="v_dpt">
                </div>       
              </div>

              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="v_gsttype" style="color:rgb(190, 88, 88);">GST Treatment *</label>
                </div>
                <div class="col-md-6 mt-2">
                  <select class="form-control text-dark bg-light" id="v_gsttype" name="v_gsttype" required>
                    <option selected disabled value="">Choose..</option>
                    <option value="Registered Business - Regular">Registered Business - Regular <span><i>(Business that is registered under gst)</i></span></option>
                    <option value="Registered Business - Composition">Registered Business - Composition (Business that is registered under composition scheme in gst)</option>
                    <option value="unregistered Business">Unregistered Business (Business that has not been registered under gst)</option>
                    <option value="Overseas">Overseas (Import/Export of supply outside india)</option>
                    <option value="Special Economic Zone (SEZ)">Special Economic Zone (SEZ) (Business that is located in a special economic zone of india or a SEZ developer)</option>
                    <option value="Demed Exports">Demed Exports (Supply of woods to an exports oriented unit or againsed advanced authorization or export promotion capital woods)</option>
                    <option value="Tax Deductor">Tax Deductor (State of central gov,government agencies or local authority)</option>
                    <option value="SEZ Developer">SEZ Developer (A person or organization who owns atleast 26% eqaulity in creating business units in special economic zone)</option>
                  </select> 
                  

                </div> 
                      
              </div>
              <div class="row gstrow d-none">
                <div class="col-md-3 mt-2">
                  <label id="glbl" style="color:rgb(190, 88, 88);">GSTIN/UIN *</label>
                </div>
                <div class="col-md-6 mt-2">
                  <input type="text" class="form-control text-dark bg-light" id="v_gstin" name="v_gstin" placeholder="29APPCK7465F1Z1">
                  <label id="gst_label"></label>
                </div>       
              </div>

             
              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="v_pan">PAN Number</label>
                </div>
                <div class="col-md-6 mt-2">
                  <input type="text" class="form-control text-dark bg-light" id="v_pan" name="v_pan" placeholder="APPCK7465F">
                  <label id="pan_label"></label>
                </div>       
              </div>

              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="" style="color: rgb(190, 88, 88);">Source of Supply *</label>
                </div>
                <div class="col-md-6 mt-2">
                  <select class="form-control text-dark bg-light" id="v_srcsupply" name="v_sourceofsupply">
                    <option value="Nill"></option>
                    <option value="[AN] Andaman and Nicobar Islads">[AN] Andaman and Nicobar Islads</option>
                    <option value="[AD] Andhra Predhesh">[AD] Andhra Predhesh</option>
                    <option value="[AR] Arunachal Predesh">[AR] Arunachal Predesh</option>
                    <option value="[AS] Assam">[AS] Assam</option>
                    <option value="[BR] Bihar">[BR] Bihar</option>
                    <option value="[CH] Chandigarh">[CH] Chandigarh</option>
                    <option value="[CG] Chhattisgarh">[CG] Chhattisgarh</option>
                    <option value="[DNH] Dadra and Nagar Haveli">[DNH] Dadra and Nagar Haveli</option>
                    <option value="[DD] Damn anad Diu">[DD] Damn anad Diu</option>
                    <option value="[DL] Delhi">[DL] Delhi</option>
                    <option value="[GA] Goa">[GA] Goa</option>
                    <option value="[GJ] Gujarat">[GJ] Gujarat</option>
                    <option value="[HR] Haryana">[HR] Haryana</option>
                    <option value="[HP] Himachal Predesh">[HP] Himachal Predesh</option>
                    <option value="[JK] Jammu and Kashmir">[JK] Jammu and Kashmir</option>
                    <option value="[JH] Jharkhand">[JH] Jharkhand</option>
                    <option value="[KA] Karnataka">[KA] Karnataka</option>
                    <option value="[KL] Kerala">[KL] Kerala</option>
                    <option value="[LA] Ladakh">[LA] Ladakh</option>
                    <option value="[LD] Lakshadweep">[LD] Lakshadweep</option>
                    <option value="[MP] Madhya Predesh">[MP] Madhya Predesh</option>
                    <option value="[MH] Maharashtra">[MH] Maharashtra</option>
                    <option value="[MN] Manipur">[MN] Manipur</option>
                    <option value="[ML] Meghalaya">[ML] Meghalaya</option>
                    <option value="[MZ] Mizoram">[MZ] Mizoram</option>
                    <option value="[NL] Nagaland">[NL] Nagaland</option>
                    <option value="[OD] Odisha">[OD] Odisha</option>
                    <option value="[PY] Puducherry">[PY] Puducherry</option>
                    <option value="[PB] Punjab">[PB] Punjab</option>
                    <option value="[RJ] Rajasthan">[RJ] Rajasthan</option>
                    <option value="[SK] Sikkim">[SK] Sikkim</option>
                    <option value="[TN] Tamil Nadu">[TN] Tamil Nadu</option>
                    <option value="[TS] Telangana">[TS] Telangana</option>
                    <option value="[TR] Tripura">[TR] Tripura</option>
                    <option value="[UP] Uttar Predesh">[UP] Uttar Predesh</option>
                    <option value="[UK] Uttarakhand">[UK] Uttarakhand</option>
                    <option value="[WB] West Bengal">[WB] West Bengal</option>
                    <option value="[OT] Other Territory">[OT] Other Territory</option>
                  </select>
                </div>       
              </div>

              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="v_curn">Currency </label>
                </div>
                <div class="col-md-3 mt-2">
                  <select class="form-control text-dark bg-light" id="v_curn" name="currency" required>
                    <option selected disabled value="">Choose..</option>
                    <option value="INR">INR</option>
                  </select>
                </div>       
              </div>

              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="v_open">Opening Balance</label>
                </div>
                <div class="col-md-6 mt-2">
                  <input type="text" class="form-control text-dark bg-light" id="v_open" name="v_open">
                </div>       
              </div>

              <div class="row">
                <div class="col-md-3 mt-2">
                  <label for="v_terms">Payment Terms</label>
                </div>
                <div class="col-md-6 mt-2">
                  <div class="d-flex">
                    <select class="form-control text-dark bg-light" id="paymentTermsDropdown" name="v_terms" required>
                     
                      {% for p in payments %}
                      <option value="{{p.id}}">{{p.Terms}}</option>
                      {% endfor %}
                    </select>                
                    <a href="#" class="btn btn-outline-secondary py-2 my-1" id="openPaymentModalBtn" data-target="#newpayment" data-toggle="modal">+</a>   
                  </div>
                </div>       
              </div>
              

              <hr>

              <div class="row">
                <div class="col-md-6 mt-5 text-center text-uppercase">
                  <h4 class="mb-0">Billing Address</h4>
                </div>
                <div class="col-md-6 mt-5">
                  <h4 class="mb-0 text-center text-uppercase">Shipping Address</h4>
                </div>
              </div>
              <div class="row mt-2 m-0 p-0 mb-2">
                <div class="col-md-9"> </div>
                <div class="col-md-3 text-right  m-0 p-0">
                  <input type="checkbox" onclick="addressSame()" id="vokay" name="vokay">
                  <label for="vokay" style="color: #909091;">Same As Billing Address</label>
                </div>
              </div>

              <div class="row mt-5">
                <div class="col-md-1">
                  <label for="vstreet">Street</label>
                </div>
                <div class="col-md-4">
                  <textarea class="form-control street text-dark bg-light" id="vstreet" name="vstreet"></textarea>
                </div>
                <div class="col-md-1"></div>

                <div class="col-md-1">
                  <label for="vsstreet">Street</label>
                </div>
                <div class="col-md-4 ">
                  <textarea class="form-control street text-dark bg-light" id="vsstreet" name="vsstreet"></textarea>
                </div>
                <div class="col-md-1"></div>

              </div>

              <div class="row mt-2">
                <div class="col-md-1">
                  <label for="vcity">City</label>
                </div>
                <div class="col-md-4">
                  <input type="text" class="form-control text-dark bg-light" id="vcity" name="vcity" placeholder="City">  
                </div>
                <div class="col-md-1">
                </div>
                <div class="col-md-1">
                  <label for="vscity">City</label>
                </div>
                <div class="col-md-4">
                  <input type="text" class="form-control text-dark bg-light" id="vscity" name="vscity" placeholder="City">  
                </div>
                <div class="col-md-1">
                </div>
              </div>

              <div class="row mt-2">
                <div class="col-md-1">
                  <label for="vstate">State</label>
                </div>
                <div class="col-md-4">
                  <select type="text" class="form-control text-dark bg-light" id="vstate" name="vstate">
                    <option value="" selected>Choose</option>
                    <option value="None Of This">None Of This</option>
                    <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads
                    </option>
                    <option value="Andhra Predhesh">Andhra Predhesh</option>
                    <option value="Arunachal Predesh">Arunachal Predesh</option>
                    <option value="Assam">Assam</option>
                    <option value="Bihar">Bihar</option>
                    <option value="Chandigarh">Chandigarh</option>
                    <option value="Chhattisgarh">Chhattisgarh</option>
                    <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                    <option value="Damn anad Diu">Damn anad Diu</option>
                    <option value="Delhi">Delhi</option>
                    <option value="Goa">Goa</option>
                    <option value="Gujarat">Gujarat</option>
                    <option value="Haryana">Haryana</option>
                    <option value="Himachal Predesh">Himachal Predesh</option>
                    <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                    <option value="Jharkhand">Jharkhand</option>
                    <option value="Karnataka">Karnataka</option>
                    <option value="Kerala">Kerala</option>
                    <option value="Ladakh">Ladakh</option>
                    <option value="Lakshadweep">Lakshadweep</option>
                    <option value="Madhya Predesh">Madhya Predesh</option>
                    <option value="Maharashtra">Maharashtra</option>
                    <option value="Manipur">Manipur</option>
                    <option value="Meghalaya">Meghalaya</option>
                    <option value="Mizoram">Mizoram</option>
                    <option value="Nagaland">Nagaland</option>
                    <option value="Odisha">Odisha</option>
                    <option value="Puducherry">Puducherry</option>
                    <option value="Punjab">Punjab</option>
                    <option value="Rajasthan">Rajasthan</option>
                    <option value="Sikkim">Sikkim</option>
                    <option value="Tamil Nadu">Tamil Nadu</option>
                    <option value="Telangana">Telangana</option>
                    <option value="Tripura">Tripura</option>
                    <option value="Uttar Predesh">Uttar Predesh</option>
                    <option value="Uttarakhand">Uttarakhand</option>
                    <option value="West Bengal">West Bengal</option>
                    <option value="Other Territory">Other Territory</option>
                  </select>
                </div>
                <div class="col-md-1"></div>

                <div class="col-md-1">
                  <label for="vsstate">State</label>
                </div>
                <div class="col-md-4 ">
                  <select type="text" class="form-control text-dark bg-light" id="vsstate" name="vsstate">
                    <option value="" selected>Choose</option>
                    <option value="None Of This">None Of This</option>
                    <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads
                    </option>
                    <option value="Andhra Predhesh">Andhra Predhesh</option>
                    <option value="Arunachal Predesh">Arunachal Predesh</option>
                    <option value="Assam">Assam</option>
                    <option value="Bihar">Bihar</option>
                    <option value="Chandigarh">Chandigarh</option>
                    <option value="Chhattisgarh">Chhattisgarh</option>
                    <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                    <option value="Damn anad Diu">Damn anad Diu</option>
                    <option value="Delhi">Delhi</option>
                    <option value="Goa">Goa</option>
                    <option value="Gujarat">Gujarat</option>
                    <option value="Haryana">Haryana</option>
                    <option value="Himachal Predesh">Himachal Predesh</option>
                    <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                    <option value="Jharkhand">Jharkhand</option>
                    <option value="Karnataka">Karnataka</option>
                    <option value="Kerala">Kerala</option>
                    <option value="Ladakh">Ladakh</option>
                    <option value="Lakshadweep">Lakshadweep</option>
                    <option value="Madhya Predesh">Madhya Predesh</option>
                    <option value="Maharashtra">Maharashtra</option>
                    <option value="Manipur">Manipur</option>
                    <option value="Meghalaya">Meghalaya</option>
                    <option value="Mizoram">Mizoram</option>
                    <option value="Nagaland">Nagaland</option>
                    <option value="Odisha">Odisha</option>
                    <option value="Puducherry">Puducherry</option>
                    <option value="Punjab">Punjab</option>
                    <option value="Rajasthan">Rajasthan</option>
                    <option value="Sikkim">Sikkim</option>
                    <option value="Tamil Nadu">Tamil Nadu</option>
                    <option value="Telangana">Telangana</option>
                    <option value="Tripura">Tripura</option>
                    <option value="Uttar Predesh">Uttar Predesh</option>
                    <option value="Uttarakhand">Uttarakhand</option>
                    <option value="West Bengal">West Bengal</option>
                    <option value="Other Territory">Other Territory</option>
                  </select>
                </div>

                <div class="col-md-1"></div>

              </div>

              <div class="row mt-2">
                <div class="col-md-1">
                  <label for="vcountry">Country</label>
                </div>
                <div class="col-md-4 ">
                  <input type="text" class="form-control text-dark bg-light" id="vcountry" name="vcountry" placeholder="Country">  
                </div>
                <div class="col-md-1"></div>

                <div class="col-md-1">
                  <label for="vscountry">Country</label>
                </div>
                <div class="col-md-4">
                  <input type="text" class="form-control text-dark bg-light" id="vscountry"  name="vscountry" placeholder="Country">
                </div>
                <div class="col-md-1 "></div>

              </div>

              <div class="row mt-2">

                <div class="col-md-1">
                  <label for="vpincode">Pincode</label>
                </div>
                <div class="col-md-4">
                  <input type="text" class="form-control text-dark bg-light" id="vpincode" name="vpincode" maxlength="6" placeholder="PIN Code"> 
                </div>
                <div class="col-md-1"></div>

                <div class="col-md-1">
                  <label for="vspincode">Pincode</label>
                </div>
                <div class="col-md-4">
                  <input type="text" class="form-control text-dark bg-light" id="vspincode" name="vspincode" maxlength="6"  placeholder="PIN Code">  
                </div>
                <div class="col-md-1"></div>

              </div>

              <div class="row mt-2">

                <div class="col-md-1">
                  <label for="vphone">Phone</label>
                </div>
                <div class="col-md-4">
                  <input type="text" class="form-control text-dark bg-light" id="vphone" name="vphone"  placeholder="Phone"> 
                </div>
                <div class="col-md-1"></div>

                <div class="col-md-1">
                  <label for="vsphone">Phone</label>
                </div>
                <div class="col-md-4">
                  <input type="text" class="form-control text-dark bg-light" id="vsphone" name="vsphone"  placeholder="Phone">  
                </div>
                <div class="col-md-1"></div>

              </div>

              <div class="row mt-2">

                <div class="col-md-1">
                  <label for="vfax">Fax</label>
                </div>
                <div class="col-md-4">
                  <input type="text" class="form-control text-dark bg-light" id="vfax" name="vfax"  placeholder="FAX"> 
                </div>
                <div class="col-md-1"></div>

                <div class="col-md-1">
                  <label for="vsfax">Fax</label>
                </div>
                <div class="col-md-4">
                  <input type="text" class="form-control text-dark bg-light" id="vsfax" name="vsfax"  placeholder="FAX">  
                </div>
                <div class="col-md-1"></div>

              </div>

              <div class="row">
                  <div class="col-md-6">
                    <input type="checkbox" value="" id="invalidCheck" name="invalidCheck" required>
                    <label for="invalidCheck" style="color: #909091;">Agree to terms and conditions</label>
                    <div class="invalid-feedback text-warning" >You must agree before submitting.</div>
                  </div>
              </div>
              <div class="row">
                <div class="col-md-4">
                  <div class="d-flex">
                    <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                    type="submit" data-dismiss="modal" id="vendorSave">Submit
                    </button> 

                    <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                      data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">Cancel</span>
                    </button>
                  </div>
                </div>
                <div class="col-md-6"></div>
                <!-- <div class="col-md-4"></div> -->
              </div>
            </form>
                </div>
            </div>
        </div>
    </div>  
  </div>  
<!-- end modal -->

<div class="modal fade" id="newpayment">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header " style="background: rgb(32, 35, 37);">
          <h3 class="m-3 text-uppercase">Add Payment Term</h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3">
          <form action="" method="post" class="needs-validation"  id="paymentTermsForm">
            {% csrf_token %}
            <div class="row mt-2">
              <div class="col-md-2 mt-2"></div>
              <div class="col-md-4 mt-2">
                <center><label for="termname" style="color: rgb(190, 88, 88);">Term Name *</label></center>
              </div>

              <div class="col-md-4 mt-2">
                <center><label for="termdays" style="color: rgb(190, 88, 88);">Number of Days *</label></center>
              </div>
              <div class="col-md-2 mt-2"></div>
            </div>


            <div class="row mt-2">
              <div class="col-md-2 mt-2"></div>

              <div class="col-md-4 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="term_name" name="term_name" required>      
              </div>

              <div class="col-md-4 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="term_days" name="term_days" required>
              </div>
              <div class="col-md-2 mt-2"></div>

            </div>
            
            <div class="row mt-5">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                  type="submit"   id="paySave">Save
                  </button> 
                  

                  <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                    data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>  
</div>  
<script>
  $(document).ready(function() {
    // AJAX for adding payment term
    $("#paymentTermsForm").submit(function(event) {
        event.preventDefault();
        var formData = $(this).serialize();
        $.ajax({
            url: "{% url 'custmr_payment' %}",
            type: "POST",
            data: formData,
            success: function(data) {
                if (data.success) {
                    console.log('Payment term added successfully:', data);
                    // Clear the form and reload the dropdown on success
                    $("#paymentTermsForm")[0].reset();
                    loadPaymentTerms();
                    closeForm()
                } else {
                    // Handle form validation errors
                    console.log('Error adding payment term:', data.errors);
                }
            },
            error: function(error) {
                console.log("Error:", error);
            }
        });
    });

    // Function to load payment terms into the dropdown
    function loadPaymentTerms() {
        $.ajax({
            url: "{% url 'payment_view' %}",
            type: "GET",
            success: function(data) {
                console.log('Received payment terms data:', data);
                var dropdown = $("#c_terms");
                var dropdown1 = $("#paymentTermsDropdown"); 
                dropdown.empty();
                dropdown1.empty();
                $.each(data, function(key, value) {
                    var optionText = value[1];
                    var optionValue = key;
                    dropdown.append($('<option></option>').attr('value', optionValue).text(optionText));
                    dropdown1.append($('<option></option>').attr('value', optionValue).text(optionText));
                    console.log('Added option:', optionValue, optionText);
                });
            },
            error: function(error) {
                console.log("Error:", error);
            }
        });
    }

    // Initial load of payment terms
    loadPaymentTerms();
});
function closeForm() {
  let formContainer = document.getElementById("newpayment");
  formContainer.style.display = "none";
}
</script>



<script>
  function addressSame() {
    const billingStreet = document.getElementById("vstreet").value;
    const billingCity = document.getElementById("vcity").value;
    const billingState = document.getElementById("vstate").value;
    const billingCountry = document.getElementById("vcountry").value;
    const billingPincode = document.getElementById("vpincode").value;
    const billingPhone = document.getElementById("vphone").value;
    const billingFax = document.getElementById("vfax").value;
  
    if (document.getElementById("vokay").checked) {
      // Set shipping address fields to billing address fields
      document.getElementById("vsstreet").value = billingStreet;
      document.getElementById("vscity").value = billingCity;
      document.getElementById("vsstate").value = billingState;
      document.getElementById("vscountry").value = billingCountry;
      document.getElementById("vspincode").value = billingPincode;
      document.getElementById("vsphone").value = billingPhone;
      document.getElementById("vsfax").value = billingFax;
    } else {
      // Clear the shipping address fields if checkbox is unchecked
      document.getElementById("vsstreet").value = "";
      document.getElementById("vscity").value = "";
      document.getElementById("vsstate").value = "";
      document.getElementById("vscountry").value = "";
      document.getElementById("vspincode").value = "";
      document.getElementById("vsphone").value = "";
      document.getElementById("vsfax").value = "";
    }
  }
  

</script>
<script>
  function address() {
    const billingStreet1 = document.getElementById("cstreet1").value;
    const billingStreet2 = document.getElementById("cstreet2").value;
    const billingCity = document.getElementById("ccity").value;
    const billingState = document.getElementById("cstate").value;
    const billingCountry = document.getElementById("ccountry").value;
    const billingPincode = document.getElementById("cpincode").value;
    const billingPhone = document.getElementById("cphone").value;
    const billingFax = document.getElementById("cfax").value;
  
    if (document.getElementById("csokay").checked) {
      // Set shipping address fields to billing address fields
      document.getElementById("csstreet1").value = billingStreet1;
      document.getElementById("csstreet2").value = billingStreet2;
      document.getElementById("cscity").value = billingCity;
      document.getElementById("csstate").value = billingState;
      document.getElementById("cscountry").value = billingCountry;
      document.getElementById("cspincode").value = billingPincode;
      document.getElementById("csphone").value = billingPhone;
      document.getElementById("csfax").value = billingFax;
    } else {
      // Clear the shipping address fields if checkbox is unchecked
      document.getElementById("csstreet1").value = "";
      document.getElementById("csstreet2").value = "";
      document.getElementById("cscity").value = "";
      document.getElementById("csstate").value = "";
      document.getElementById("cscountry").value = "";
      document.getElementById("cspincode").value = "";
      document.getElementById("csphone").value = "";
      document.getElementById("csfax").value = "";
    }
  }
  
</script>

<script>
  $(document).ready(function() {
    $("#v_gsttype").change(function() {
      var x=$('#v_gsttype').val();
      if(x=="unregistered Business") 
      {
        $(".gstrow").addClass('d-none');

      }
      else if(x == 'Overseas'){
        $(".gstrow").addClass('d-none');
      }
      else 
      {
        $(".gstrow").removeClass('d-none');
        $(".gstrow").addClass('d-flex');
      }
    
    });
  });


    $(document).ready(function() {
    $("#v_gstin").change(function() {

        var x=$("v_gstin").val();
        var gst_label=document.getElementById("gst_label")
        var expr=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;
        if (!expr.test(x)) {
            gst_label.style.color="red";
            gst_label.innerHTML = "Invalid GST Number.";
        }
        else{
            gst_label.style.color="green";
            gst_label.innerHTML = "valid GST Number.";

        }
      });
    });

    $(document).ready(function() {
      $("#v_pan").change(function() {
        var x= $("#v_pan").val();
        var pan_label=document.getElementById("pan_label")
        var expr=    /^[A-Z]{5}[0-9]{4}[A-Z]{1}$/
        if (!expr.test(x)) {
            pan_label.style.color="red";
            pan_label.innerHTML = "Invalid PAN Number.";
        }
        else{
            pan_label.style.color="green";
            pan_label.innerHTML = "valid PAN Number.";

        }
      });
    });
</script>

<script>
  function addressSame() {
      const billingStreet = document.getElementById("vstreet").value;
      const billingCity = document.getElementById("vcity").value;
      const billingState = document.getElementById("vstate").value;
      const billingCountry = document.getElementById("vcountry").value;
      const billingPincode = document.getElementById("vpincode").value;
      const billingPhone = document.getElementById("vphone").value;
      const billingFax = document.getElementById("vfax").value;
  
      if (document.getElementById("vokay").checked) {
          document.getElementById("vsstreet").value = billingStreet;
          document.getElementById("vscity").value = billingCity;
          document.getElementById("vsstate").value = billingState;
          document.getElementById("vscountry").value = billingCountry;
          document.getElementById("vspincode").value = billingPincode;
          document.getElementById("vsphone").value = billingPhone;
          document.getElementById("vsfax").value = billingFax;
      } else {
          // Clear the shipping address fields if checkbox is unchecked
          document.getElementById("vsstreet").value = "";
          document.getElementById("vscity").value = "";
          document.getElementById("vsstate").value = "";
          document.getElementById("vscountry").value = "";
          document.getElementById("vspincode").value = "";
          document.getElementById("vsphone").value = "";
          document.getElementById("vsfax").value = "";
      }
  }
  </script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
 
    <script>
        $(document).ready(function() {
            $("#vendorSave").on("click", function(event) {
                event.preventDefault();
                var formData = $("#vendorForm").serialize();
    
                $.ajax({
                    url: "{% url 'add_recurring_vendor' %}",
                    type: "POST",
                    data: formData,
                    headers: { "X-CSRFToken": "{{ csrf_token }}" },
                    success: function(data) {
                        console.log("AJAX Success:", data);
    
                        if (data.success) {
                            alert("Vendor added successfully!");
                            $("#vendorForm")[0].reset();
                            updateVendorDropdown(data.vendorId, data.vendorName,); // Pass the newly added vendor's ID and Name
                        } else {
                            alert("Vendor addition failed!");
                        }
                    },
                    error: function(error) {
                        console.log("AJAX Error:", error);
                    }
                });
            });
    
            function updateVendorDropdown(vendorId, vendorName) {
                // Append the new vendor to the select dropdown
                $("#vendorSelect").append($('<option>', {
                    value: vendorId,
                    text: vendorName,
                    
                }));
            }
        });
    </script>
    












<script>
  var goodsRadio = document.getElementById('expense_type1');
  var goodsBottom = document.getElementById('goods-bottom');
  
  goodsRadio.addEventListener('change', function() {
    if (this.checked) {
      goodsBottom.style.display = 'block';
      servicesBottom.style.display = 'none';
    }
  });

  var servicesRadio = document.getElementById('expense_type2');
  var servicesBottom = document.getElementById('services-bottom');
  
  servicesRadio.addEventListener('change', function() {
    if (this.checked) {
      goodsBottom.style.display = 'none';
      servicesBottom.style.display = 'block';
    }
  });
</script>
<script>
  function validateGSTNumber(gstNumber) {
    // Regular expression to validate GST number
    var gstRegex = /^([0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1})$/;

    // Check if the entered GST number matches the regex pattern
    if (!gstRegex.test(gstNumber)) {
      alert("Invalid GST number. Please enter a valid GST number.");
      return false;
    }
    return true;
  }

  function validateForm() {
    var gstTreatment = document.getElementById("gst").value;

    // Check if the selected GST treatment requires GST number validation
    if (gstTreatment !== "Unregistered Business-not Registered under GST") {
      var gstNumber = document.getElementById("textbox").value;
      return validateGSTNumber(gstNumber);
    }

    return true;
  }
</script>


 <script>
  function toggleTextBox() {
    var gstTreatment = document.getElementById("gst_trt_inp").value;
    var textboxContainer = document.getElementById("textboxContainer");
    var textbox = document.getElementById("gstin_inp");

    if (gstTreatment !== "Unregistered Business-not Registered under GST") {
      textboxContainer.style.display = "block";
      textbox.value = getGstNumber();
    } else {
      textboxContainer.style.display = "none";
      textbox.value = "";
    }
  }

  function getGstNumber() {
    var vendorSelect = document.getElementById("vendorSelect");
    var selectedVendorId = vendorSelect.value;
    var selectedVendorOption = vendorSelect.options[vendorSelect.selectedIndex];
    var gstNumber = selectedVendorOption.getAttribute("data-gst-number");
    return gstNumber || ""; // Return an empty string if GST number is undefined
  }

  // Call toggleTextBox initially to set the initial state of the textbox
  toggleTextBox();
</script>
<script>
  function toggleTextBox() {
    var gstTreatment = document.getElementById("gst_trt_inp").value;
    var textboxContainer = document.getElementById("textboxContainer");
    var textbox = document.getElementById("gstin_inp");

    if (gstTreatment !== "Unregistered Business-not Registered under GST") {
      textboxContainer.style.display = "block";
      textbox.value = getGstNumber();
    } else {
      textboxContainer.style.display = "none";
      textbox.value = "";
    }
  }

  function getGstNumber() {
    var vendorSelect = document.getElementById("vendorSelect");
    var selectedVendorId = vendorSelect.value;
    var selectedVendorOption = vendorSelect.options[vendorSelect.selectedIndex];
    var gstNumber = selectedVendorOption.getAttribute("data-gst-number");
    return gstNumber || ""; // Return an empty string if GST number is undefined
  }

  // Call toggleTextBox initially to set the initial state of the textbox
  toggleTextBox();
</script> 


<script>
  function validateHSN(input) {
    const hsnValue = input.value.trim();
    const hsnError = document.getElementById('hsn-error');
  
    if (hsnValue.length === 6 && /^[0-9]+$/.test(hsnValue)) {
      hsnError.textContent = '';
    } else {
      hsnError.textContent = 'Please enter a valid 6-digit number.';
    }
  }
  function validateSAC(input) {
    const sacValue = input.value.trim();
    const sacError = document.getElementById('sac-error');

    if (sacValue.length === 6 && /^[0-9]+$/.test(sacValue)) {
        sacError.textContent = '';
    } else {
        sacError.textContent = 'Please enter a valid 6-digit number.';
    }
}
  </script>

 
  
  
  
  

  


    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
   <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script> 

 
{% endblock %}
    
  






